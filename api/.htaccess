RewriteEngine On

# Redireciona tudo para /public
RewriteRule ^$ public/ [L]
RewriteRule (.*) public/$1 [L]

# Bloqueia arquivos sensíveis
<FilesMatch "^(\.env|\.env\.local|composer\.json|composer\.lock|docker-compose\.yml|\.git|\.htaccess|.*\.phar|.*\.ini|.*\.sql)$">
  Require all denied
</FilesMatch>

# Segurança básica
Header always set X-Frame-Options "DENY"
Header always set X-Content-Type-Options "nosniff"
Header always set Referrer-Policy "no-referrer-when-downgrade"
Header always set Permissions-Policy "geolocation=(), microphone=(), camera=()"

# Bloqueia TRACE/TRACK
RewriteCond %{REQUEST_METHOD} ^(TRACE|TRACK)
RewriteRule .* - [F]
